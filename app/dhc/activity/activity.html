<div class="four-column-layout">


    <section>
        <h4 translate>{{ 'activity.header.first.' + mode }}</h4>

        <div class="btn-group btn-group-justified">
            <a class="btn btn-primary"
               ng-click="activityController.active = true; activityController.formActive = activityController.formEnabled"
               ng-class="{ invisible: activityController.active || activityController.dismissed }"

               >{{ 'activity.link.' + mode | translate }}</a>

            <a class="btn btn-primary"
                    ng-show="socialInteraction"
                    ng-click="dismiss()"

                    ng-disabled="activityController.dismissed"
                    translate>activity.link.dismiss</a>
        </div>

        <div>

            <activity-offer-card

                    ng-if="socialInteraction" ng-class="{ dismissed: activityController.dismissed }"

                    idea="idea"
                    activity="activity"
                    social-interaction="socialInteraction"

                    ></activity-offer-card>

        </div>

        <div>

            <idea-card idea="idea" activity="activity"></idea-card>

        </div>
    </section>

    <section>
        <h4 translate>activity.header.second</h4>

        <div ng-show="activityController.active && !activityController.formActive">

            <div class="btn-group-justified" ng-if="activityController.formEnabled">
                <a class="btn btn-default" ng-click="activityController.formActive = activityController.formEnabled" ng-disabled="activity.editStatus.indexOf('editable') !== 0" translate>activity.link.edit</a>
                <a class="btn btn-default" ng-click="deleteActivity()" ng-disabled="activity.deleteStatus.indexOf('deletable') !== 0" translate>activity.link.delete</a>

            </div>

            <br/>

            <activity-view activity="activity"></activity-view>

        </div>

        <div ng-if="activityController.active && activityController.formActive">
            <activity-edit activity="activity"></activity-edit>
        </div>

        <div ng-if="activityController.active">

            <div>
                <h4 translate>activity.header.invitedUsers</h4>
            </div>

            <div class="invitedUser"
                 ng-repeat="user in invitedUsers">

                <div ng-if="user.fullname">
                    <div><img class="avatar" ng-src="{{ user.avatar }}"/></div>
                    <div bind-html-unsafe="user.fullname || user"></div>
                    <div>{{ 'activity.invitationStatus.' + user.invitationStatus | translate }}</div>
                </div>
                <div ng-if="!user.fullname">
                    <div><i class="fa fa-envelope-o"></i></div>
                    <div>{{ user }}</div>
                    <div></div>
                </div>

            </div>
        </div>

        <div ng-show="activityController.active && activityController.formEnabled">

            <div>
                <h4 translate>activity.header.inviteOthers</h4>
            </div>

            <div class="btn-group btn-group-justified">

                <a type="button" class="btn btn-default" ng-model="$parent.inviteOthers" ng-disabled="inviteLocked"
                   btn-radio="'selected'" translate>activity.inviteOthers.selected
                </a>
                <a type="button" class="btn btn-default" ng-model="$parent.inviteOthers" ng-disabled="inviteLocked"
                   btn-radio="'all'" translate>activity.inviteOthers.all
                </a>
            </div>

            <div ng-if="inviteOthers == 'selected'">

                <div ng-if="!activityController.inviteByEmail">
                    <user-invitation type="activity" excluded-users="usersExcludedForInvitation" on-user-selected="onUserSelected"></user-invitation>
                    <a ng-click="activityController.inviteByEmail = true" translate>activity.inviteOthers.inviteByEmail</a>
                </div>
                <div ng-if="activityController.inviteByEmail">
                    <email-invitation type="activity" activity="activity" on-email-submitted="onUserSelected"></email-invitation>
                    <a ng-click="activityController.inviteByEmail = false" translate>activity.inviteOthers.inviteByUser</a>
                </div>


                <div class="user-to-be-invited"
                     ng-repeat="user in usersToBeInvited">
                    <img class="avatar" ng-src="{{ user.avatar }}"/>
                    <span bind-html-unsafe="user.fullname"></span>
                    <i class="fa fa-times" ng-click="removeUserToBeInvited(user)"></i>
                </div>

            </div>

        </div>

    </section>

    <section>
        <h4 translate>activity.header.third</h4>

        <div ng-show="activityController.active || activity.isOwner()">

            <div ng-repeat="event in events" class="event-list"


                    >

                <activity-event-card

                        type="feedback"
                        event="event"

                        ></activity-event-card>


                <activity-event-card ng-if="event.conflictingEvent"
                                     class="conflict"
                                     type="conflict"
                                     event="event.conflictingEvent"

                        ></activity-event-card>

            </div>

        </div>

        <div>

        </div>
    </section>

    <section>

        <div class="box">

            <button class="btn btn-default backToGame" ui-sref="dhc.game" translate>
                activity.link.back
            </button>
            <button class="btn btn-primary submit" ng-disabled="!activityController.active || (!dirty && (mode === 'recommendation' || mode === 'owned')) || (activity.isJoiningUser())" ng-click="submit()">
                {{ 'activity.submit.' + mode | translate }}
            </button>
        </div>
        <div class="box">
            <h4>health coach messages</h4>
        </div>
        <div class="box">
            <h4 translate>activity.header.comments</h4>

            <div ng-if="isScheduled">
                <activity-comments activity="activity"></activity-comments>
            </div>
        </div>

    </section>


</div>